<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°Šäº«æ——èˆ°çº§æŠ½å¥–ç³»ç»Ÿ - Ultimate</title>
    <style>
        /* ================== CSS å˜é‡ (æ ¸å¿ƒè”åŠ¨å¼•æ“) ================== */
        :root {
            /* å­—ä½“ä¸æ’ç‰ˆ */
            --font-main: "Microsoft YaHei", sans-serif;
            --title-size: 70px;
            --title-color: #ffffff;
            --title-weight: bold;
            --sub-size: 26px;
            --sub-color: rgba(255,255,255,0.9);

            /* èƒŒæ™¯ */
            --bg-image: url('èƒŒæ™¯.jpg'); 

            /* æŠ½å¥–å®¹å™¨ */
            --box-width: 900px;
            --box-height: 350px;
            --box-bg: rgba(255, 255, 255, 0.1); /* é»˜è®¤é€æ˜åº¦ */
            --box-border-size: 2px;
            --box-border-color: rgba(255, 255, 255, 0.4);

            /* æŒ‰é’® */
            --btn-w: 260px;
            --btn-h: 75px;
            --btn-bg: linear-gradient(135deg, rgba(255,255,255,0.25), rgba(255,255,255,0.05));
            --btn-border: 1px;
            
            /* å†å²è®°å½• */
            --history-show: block;
            --history-style: italic;
        }

        * { box-sizing: border-box; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: var(--font-main); }

        /* ================== å‰å°è§†è§‰ ================== */
        #frontend {
            width: 100%; height: 100%;
            background: var(--bg-image) no-repeat center center;
            background-size: cover;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; z-index: 1;
        }

        /* æ ‡é¢˜åŒºåŸŸ */
        .header { text-align: center; margin-bottom: 40px; text-shadow: 0 4px 20px rgba(0,0,0,0.6); }
        #main-title { 
            font-size: var(--title-size); color: var(--title-color); 
            font-weight: var(--title-weight); margin: 0; letter-spacing: 3px;
        }
        #sub-title { font-size: var(--sub-size); color: var(--sub-color); margin-top: 10px; }

        /* æŠ½å¥–ä¸»å®¹å™¨ (æ¯›ç»ç’ƒ) */
        #lottery-box {
            width: var(--box-width); height: var(--box-height);
            border: var(--box-border-size) solid var(--box-border-color);
            background: var(--box-bg);
            border-radius: 20px;
            backdrop-filter: blur(15px); /* æ¯›ç»ç’ƒæ ¸å¿ƒ */
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 50px; overflow: hidden;
        }

        .slots-wrapper { display: flex; justify-content: space-around; width: 100%; padding: 0 20px; }
        .slot-item {
            flex: 1; text-align: center; color: white; font-size: 2.8rem; font-weight: bold;
            text-shadow: 0 2px 10px rgba(0,0,0,0.4);
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }

        /* åŠ¨ç”»çŠ¶æ€ */
        .mode-rolling {
            filter: blur(5px); opacity: 0.8; transform: scale(0.9);
            animation: text-shake 0.1s infinite;
        }
        .mode-winner {
            color: #fff; font-style: normal;
            text-shadow: 0 0 10px #fff, 0 0 30px #feca57, 0 0 30px #ff00de; /* å‘å…‰ç‰¹æ•ˆ */
            animation: zoom-pop 0.6s cubic-bezier(0.17, 0.89, 0.32, 1.4) forwards;
        }

        @keyframes text-shake { 0% { transform: translateY(2px); } 100% { transform: translateY(-2px); } }
        @keyframes zoom-pop { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }

        /* æŠ½å¥–æŒ‰é’® */
        #draw-btn {
            width: var(--btn-w); height: var(--btn-h);
            background: var(--btn-bg);
            border: var(--btn-border) solid rgba(255,255,255,0.6);
            border-radius: 60px; color: white; cursor: pointer;
            font-size: 1.8rem; display: flex; align-items: center; justify-content: center; gap: 12px;
            backdrop-filter: blur(8px); user-select: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        #draw-btn:hover { transform: scale(1.05); background: rgba(255,255,255,0.35); }
        #draw-btn:active { transform: scale(0.95); }

        /* å†å²è®°å½• */
        #history-area {
            margin-top: 30px; width: 80%; max-height: 200px; overflow-y: auto;
            display: var(--history-show); 
            text-align: center; scrollbar-width: none;
        }
        .history-item {
            background: rgba(0,0,0,0.25); padding: 12px; margin-bottom: 8px; border-radius: 10px;
            font-size: 16px; color: white; border: 1px solid rgba(255,255,255,0.08);
            animation: slide-up 0.5s ease;
        }
        @keyframes slide-up { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* ================== åå°ç®¡ç†é¢æ¿ ================== */
        #backend-toggle {
            position: fixed; bottom: 20px; left: 20px; width: 50px; height: 50px;
            background: rgba(255,255,255,0.15); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 26px; cursor: pointer; z-index: 1000;
            backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.3);
            transition: 0.3s;
        }
        #backend-toggle:hover { background: white; color: black; transform: rotate(90deg); }

        #backend-panel {
            position: fixed; bottom: 80px; left: 20px; width: 480px; max-height: 85vh;
            background: rgba(255, 255, 255, 0.98); border-radius: 16px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5); z-index: 999;
            display: none; flex-direction: column; padding: 25px;
            overflow-y: auto; font-size: 13px; color: #333;
        }

        .section { border-bottom: 1px dashed #ddd; padding-bottom: 20px; margin-bottom: 20px; }
        .section-header { 
            font-weight: bold; color: #2980b9; margin-bottom: 15px; 
            border-left: 5px solid #3498db; padding-left: 10px; 
            display: flex; justify-content: space-between; align-items: center; user-select: none;
        }
        
        .form-row { display: flex; gap: 10px; margin-bottom: 10px; align-items: center; }
        .form-col { flex: 1; }
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 12px; color: #555; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-size: 13px; outline: none; }
        input:focus { border-color: #3498db; }
        .hint { font-size: 11px; color: #888; margin-top: -5px; margin-bottom: 8px; line-height: 1.4; }

        .btn { width: 100%; padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; color: white; margin-top: 5px; transition: 0.2s; }
        .btn-save { background: #27ae60; } .btn-save:hover { background: #219150; }
        .btn-reset { background: #c0392b; } .btn-reset:hover { background: #a93226; }
        .btn-add { background: #3498db; color: white; width: auto; padding: 0 15px; }

        /* éšè—åŠŸèƒ½åŒº (Secret) */
        #secret-zone {
            display: none; background: #fff5f5; border: 2px dashed #e74c3c; 
            padding: 15px; border-radius: 10px; margin-top: 10px;
        }
        .cheat-item { 
            background: white; padding: 5px 10px; border-radius: 4px; margin-bottom: 5px; 
            border: 1px solid #fadbd8; display: flex; justify-content: space-between; color: #c0392b;
        }
        .cheat-del { cursor: pointer; font-weight: bold; }

    </style>
</head>
<body>

<div id="frontend">
    <div class="header">
        <h1 id="main-title">å…¬å¸å¹´ä¼šç››å…¸</h1>
        <div id="sub-title">LUCKY DRAW 2025</div>
    </div>

    <div id="lottery-box">
        <div class="slots-wrapper" id="slots-area">
            <div class="slot-item">ç­‰å¾…å¼€å¥–</div>
        </div>
    </div>

    <button id="draw-btn" onclick="handleDraw()">
        <span id="btn-icon">ğŸ</span>
        <span id="btn-text">å¼€å§‹æŠ½å¥–</span>
    </button>

    <div id="history-area"></div>
</div>

<div id="backend-toggle" onclick="toggleBackend()">âš™ï¸</div>

<div id="backend-panel">
    
    <div class="section">
        <div class="section-header">1. æ ‡é¢˜ä¸èƒŒæ™¯è§†è§‰</div>
        <div class="form-row">
            <div class="form-col"><label>ä¸»æ ‡é¢˜å†…å®¹</label><input type="text" id="cfg-m-title" value="å…¬å¸å¹´ä¼šç››å…¸" oninput="syncUI()"></div>
            <div class="form-col"><label>å‰¯æ ‡é¢˜å†…å®¹</label><input type="text" id="cfg-s-title" value="LUCKY DRAW 2025" oninput="syncUI()"></div>
        </div>
        <div class="form-row">
            <div class="form-col"><label>å­—ä½“é€‰æ‹©</label>
                <select id="cfg-font" onchange="syncUI()">
                    <option value="Microsoft YaHei">å¾®è½¯é›…é»‘</option>
                    <option value="SimHei">é»‘ä½“</option>
                    <option value="KaiTi">æ¥·ä½“</option>
                    <option value="Arial">Arial</option>
                </select>
            </div>
            <div class="form-col"><label>æ ‡é¢˜é¢œè‰²</label><input type="color" id="cfg-color" value="#ffffff" oninput="syncUI()"></div>
            <div class="form-col"><label>æ ‡é¢˜å¤§å°</label><input type="number" id="cfg-size" value="70" oninput="syncUI()"></div>
        </div>
        <label>å…¨å±€èƒŒæ™¯ (å›¾ç‰‡URL æˆ– é¢œè‰²æ¸å˜)</label>
        <input type="text" id="cfg-bg" value="èƒŒæ™¯.jpg" oninput="syncUI()">
        <div class="hint">è¾“å…¥: url('image.jpg') æˆ– linear-gradient(45deg, #123, #456)</div>
    </div>

    <div class="section">
        <div class="section-header">2. éŸ³æ•ˆæ§åˆ¶</div>
        <div class="form-row">
            <div class="form-col"><label>æ»šåŠ¨éŸ³ä¹ (éŸ³ä¹1.mp3)</label><input type="text" id="cfg-music1" value="éŸ³ä¹1.mp3"></div>
            <div class="form-col"><label>éŸ³é‡(0-1)</label><input type="number" id="cfg-vol1" value="0.6" step="0.1" max="1"></div>
        </div>
        <div class="form-row">
            <div class="form-col"><label>è·å¥–éŸ³ä¹ (éŸ³ä¹2.mp3)</label><input type="text" id="cfg-music2" value="éŸ³ä¹2.mp3"></div>
            <div class="form-col"><label>éŸ³é‡(0-1)</label><input type="number" id="cfg-vol2" value="0.8" step="0.1" max="1"></div>
        </div>
        <div class="hint">è·å¥–éŸ³ä¹æ’­æ”¾3ç§’åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ‰§è¡Œæ¸éšæ¶ˆå¤±æ•ˆæœã€‚</div>
    </div>

    <div class="section">
        <div class="section-header">3. åŒºåŸŸä¸æŒ‰é’®å®šåˆ¶</div>
        <div class="form-row">
            <div class="form-col"><label>æŠ½å¥–åŒºå®½</label><input type="number" id="cfg-box-w" value="900" oninput="syncUI()"></div>
            <div class="form-col"><label>æŠ½å¥–åŒºé«˜</label><input type="number" id="cfg-box-h" value="350" oninput="syncUI()"></div>
            <div class="form-col"><label>è¾¹æ¡†å¤§å°</label><input type="number" id="cfg-box-b" value="2" oninput="syncUI()"></div>
        </div>
        <div class="form-col">
            <label>æŠ½å¥–åŒºèƒŒæ™¯é£æ ¼</label>
            <select id="cfg-box-bg" onchange="syncUI()">
                <option value="rgba(255,255,255,0.1)">å…¨é€æ˜ç£¨ç ‚ (Glass)</option>
                <option value="rgba(0,0,0,0.5)">åŠé€é»‘ (Dark)</option>
                <option value="linear-gradient(to top, rgba(255,255,255,0.2), transparent)">æ¸å˜é€æ˜</option>
            </select>
            <div class="hint">å‰å°æŠ½å¥–åŒºã€æŒ‰é’®ã€åå•èƒŒæ™¯å‡å·²è®¾ä¸ºé€æ˜é£æ ¼ã€‚</div>
        </div>
        <div class="form-row" style="margin-top:10px;">
            <div class="form-col"><label>æŒ‰é’®å®½åº¦</label><input type="number" id="cfg-btn-w" value="260" oninput="syncUI()"></div>
            <div class="form-col"><label>æŒ‰é’®å›¾æ ‡</label>
                <select id="cfg-btn-icon" onchange="syncUI()">
                    <option value="ğŸ">ğŸ ç¤¼ç‰©</option><option value="ğŸ”¥">ğŸ”¥ ç«ç„°</option><option value="âš¡">âš¡ é—ªç”µ</option>
                </select>
            </div>
            <div class="form-col"><label>è§’æ ‡å›¾æ ‡</label>
                <select id="cfg-badge" onchange="syncUI()">
                    <option value="âš™ï¸">âš™ï¸</option><option value="ğŸ”’">ğŸ”’</option><option value="ğŸ”§">ğŸ”§</option>
                </select>
            </div>
        </div>
    </div>

    <div class="section">
        <div class="section-header" id="trigger-area" onclick="handleSecretClick()" style="cursor: pointer;" title="è¿ç»­ç‚¹å‡»2æ¬¡æ‰“å¼€éšè—åŠŸèƒ½">
            4. åå•ä¸ç³»ç»Ÿè®¾ç½®
        </div>
        
        <label>åŒæ—¶ä¸­å¥–äººæ•°</label>
        <input type="number" id="cfg-count" value="1" min="1" max="10" oninput="initSlots()">

        <label>äººå‘˜åå• (ä¸­æ–‡ï¼Œé€—å·éš”å¼€ï¼Œæœ€å¤š500äºº)</label>
        <textarea id="cfg-names" rows="5">èµµä¸€,é’±äºŒ,å­™ä¸‰,æå››,å‘¨äº”,å´å…­,éƒ‘ä¸ƒ,ç‹å…«,å†¯ä¹,é™ˆå,å«åä¸€,è’‹åäºŒ,æ²ˆåä¸‰,éŸ©åå››,æ¨åäº”,åˆ˜åå…­,å¼ åä¸ƒ,æ—åå…«,é»„åä¹,æœ±äºŒå</textarea>
        
        <label>æ˜¾ç¤ºä¸­å¥–åå•</label>
        <select id="cfg-history-show" onchange="syncUI()">
            <option value="block">æ˜¾ç¤ºåˆ—è¡¨</option>
            <option value="none">ä¸æ˜¾ç¤º</option>
        </select>

        <div class="form-row" style="margin-top:10px;">
            <button class="btn btn-save" onclick="saveData()">ä¿å­˜é…ç½®å¹¶é‡ç½®</button>
            <button class="btn btn-reset" onclick="resetSystem()">æ¸…ç©ºè®°å½• (å…¨å‘˜é‡æŠ½)</button>
        </div>

        <div id="secret-zone">
            <h4 style="margin-top:0; color:#c0392b;">ğŸ˜ˆ å¿…ä¸­åå•é…ç½® (éšè—åŠŸèƒ½)</h4>
            <div class="hint">é…ç½®ç‰¹å®šè½®æ¬¡çš„å¿…ä¸­äººé€‰ã€‚æ³¨æ„ï¼šäººæ•°ä¸è¦è¶…è¿‡å•è½®æŠ½å–æ•°ã€‚</div>
            <div class="form-row">
                <input type="number" id="cheat-round" placeholder="ç¬¬å‡ è½® (å¦‚ 1)" style="flex:1;">
                <input type="text" id="cheat-who" placeholder="å§“å (å¦‚ å¼ ä¸‰,æå››)" style="flex:2;">
                <button class="btn btn-add" onclick="addCheatRule()">æ·»åŠ è§„åˆ™</button>
            </div>
            <div id="cheat-list-display"></div>
        </div>
    </div>

    <div style="text-align:center; color:#999; font-size:12px;">
        å½“å‰çŠ¶æ€ï¼šç¬¬ <span id="status-round">1</span> è½® | å‰©ä½™ <span id="status-left">0</span> äºº
    </div>
</div>

<audio id="audio-roll" loop></audio>
<audio id="audio-win"></audio>

<script>
    // --- å…¨å±€çŠ¶æ€ ---
    let fullList = [];
    let available = [];
    let winners = [];
    let isRolling = false;
    let rollTimer = null;
    let currentRound = 1;
    let clickCount = 0; // ç”¨äºæ£€æµ‹åŒå‡»
    let cheatRules = {}; // æ ¼å¼: { 1: ['å¼ ä¸‰'], 2: ['æå››', 'ç‹äº”'] }

    // --- åˆå§‹åŒ– ---
    window.onload = () => {
        saveData();
        syncUI();
    };

    // --- UI æ§åˆ¶ ---
    function toggleBackend() {
        const p = document.getElementById('backend-panel');
        p.style.display = (p.style.display === 'flex') ? 'none' : 'flex';
    }

    function syncUI() {
        const root = document.documentElement.style;
        const val = (id) => document.getElementById(id).value;

        // æ–‡æœ¬
        document.getElementById('main-title').innerText = val('cfg-m-title');
        document.getElementById('sub-title').innerText = val('cfg-s-title');
        root.setProperty('--font-main', val('cfg-font'));
        root.setProperty('--title-color', val('cfg-color'));
        root.setProperty('--title-size', val('cfg-size') + 'px');

        // èƒŒæ™¯ (è‡ªåŠ¨åˆ¤æ–­æ˜¯å›¾ç‰‡è¿˜æ˜¯æ¸å˜)
        let bg = val('cfg-bg');
        if(!bg.includes('url') && !bg.includes('gradient')) bg = `url('${bg}')`;
        root.setProperty('--bg-image', bg);

        // ç›’å­
        root.setProperty('--box-width', val('cfg-box-w') + 'px');
        root.setProperty('--box-height', val('cfg-box-h') + 'px');
        root.setProperty('--box-border-size', val('cfg-box-b') + 'px');
        root.setProperty('--box-bg', val('cfg-box-bg'));

        // æŒ‰é’®
        root.setProperty('--btn-w', val('cfg-btn-w') + 'px');
        document.getElementById('btn-icon').innerText = val('cfg-btn-icon');
        document.getElementById('backend-toggle').innerText = val('cfg-badge');

        // å…¶ä»–
        root.setProperty('--history-show', val('cfg-history-show'));
    }

    // --- æ•°æ®é€»è¾‘ ---
    function saveData() {
        const text = document.getElementById('cfg-names').value;
        fullList = text.split(/[,ï¼Œ\n]/).map(s => s.trim()).filter(s => s);
        available = [...new Set(fullList)]; // å»é‡
        winners = [];
        currentRound = 1;
        document.getElementById('history-area').innerHTML = "";
        document.getElementById('status-round').innerText = 1;
        updateStatus();
        initSlots();
    }

    function resetSystem() {
        if(confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ä¸­å¥–è®°å½•ï¼Œé‡æ–°å¼€å§‹å—ï¼Ÿ")) {
            saveData();
            alert("ç³»ç»Ÿå·²é‡ç½®ï¼Œæ‰€æœ‰äººå‡å¯å†æ¬¡ä¸­å¥–ã€‚");
        }
    }

    function updateStatus() {
        document.getElementById('status-left').innerText = available.length;
    }

    function initSlots() {
        if(isRolling) return;
        const count = parseInt(document.getElementById('cfg-count').value);
        const container = document.getElementById('slots-area');
        container.innerHTML = "";
        for(let i=0; i<count; i++) {
            container.innerHTML += `<div class="slot-item">?</div>`;
        }
    }

    // --- éšè—åŠŸèƒ½ (æš—ç®±) ---
    function handleSecretClick() {
        clickCount++;
        setTimeout(() => clickCount = 0, 500); // 500mså†…å¦‚æœä¸ç‚¹ç¬¬äºŒæ¬¡åˆ™æ¸…é›¶
        if (clickCount >= 2) {
            const zone = document.getElementById('secret-zone');
            zone.style.display = (zone.style.display === 'block') ? 'none' : 'block';
            clickCount = 0;
        }
    }

    function addCheatRule() {
        const round = parseInt(document.getElementById('cheat-round').value);
        const names = document.getElementById('cheat-who').value.split(/[,ï¼Œ]/).map(s=>s.trim()).filter(s=>s);
        
        if (!round || names.length === 0) return;

        cheatRules[round] = names;
        renderRules();
        document.getElementById('cheat-who').value = '';
    }

    function renderRules() {
        const div = document.getElementById('cheat-list-display');
        let html = '';
        for (let r in cheatRules) {
            html += `<div class="cheat-item">
                        <span>ç¬¬ ${r} è½®å¿…ä¸­: ${cheatRules[r].join(', ')}</span>
                        <span class="cheat-del" onclick="deleteRule(${r})">Ã—</span>
                     </div>`;
        }
        div.innerHTML = html;
    }

    function deleteRule(r) {
        delete cheatRules[r];
        renderRules();
    }

    // --- æŠ½å¥–æ ¸å¿ƒ ---
    function handleDraw() {
        const btnText = document.getElementById('btn-text');
        const count = parseInt(document.getElementById('cfg-count').value);
        const audioRoll = document.getElementById('audio-roll');
        const audioWin = document.getElementById('audio-win');

        if (!isRolling) {
            // == å¼€å§‹æŠ½å¥– ==
            if (available.length < count) {
                alert("å‰©ä½™äººæ•°ä¸è¶³ï¼Œè¯·åœ¨åå°é‡ç½®ï¼");
                return;
            }

            isRolling = true;
            btnText.innerText = "åœæ­¢æŠ½å¥–";
            
            // æ’­æ”¾æ»šåŠ¨éŸ³ä¹
            audioRoll.src = document.getElementById('cfg-music1').value;
            audioRoll.volume = document.getElementById('cfg-vol1').value;
            audioRoll.play().catch(e => console.log("ç­‰å¾…äº¤äº’"));

            const slots = document.querySelectorAll('.slot-item');
            
            // æ»šåŠ¨åŠ¨ç”»é€»è¾‘
            rollTimer = setInterval(() => {
                slots.forEach(slot => {
                    const r = Math.floor(Math.random() * available.length);
                    slot.innerText = available[r];
                    slot.className = 'slot-item mode-rolling';
                });
            }, 80);

        } else {
            // == åœæ­¢æŠ½å¥– ==
            isRolling = false;
            btnText.innerText = "å¼€å§‹æŠ½å¥–";
            clearInterval(rollTimer);
            
            // åœæ­¢æ»šåŠ¨éŸ³ä¹
            audioRoll.pause();
            audioRoll.currentTime = 0;

            // æ’­æ”¾ä¸­å¥–éŸ³ä¹ + æ·¡å‡º
            audioWin.src = document.getElementById('cfg-music2').value;
            audioWin.volume = document.getElementById('cfg-vol2').value;
            audioWin.play();
            
            // 3ç§’æ·¡å‡ºé€»è¾‘
            setTimeout(() => {
                let vol = audioWin.volume;
                const fade = setInterval(() => {
                    if (vol > 0.05) { vol -= 0.05; audioWin.volume = vol; }
                    else { audioWin.pause(); clearInterval(fade); }
                }, 100);
            }, 2500);

            // å†³å®šä¸­å¥–è€…
            let roundWinners = [];
            
            // 1. æ£€æŸ¥æš—ç®±é…ç½®
            if (cheatRules[currentRound]) {
                const forced = cheatRules[currentRound];
                forced.forEach(name => {
                    // å¿…é¡»ç¡®ä¿è¿™ä¸ªäººåœ¨æ± å­é‡Œ
                    const idx = available.indexOf(name);
                    if (idx !== -1 && roundWinners.length < count) {
                        roundWinners.push(name);
                        available.splice(idx, 1);
                    }
                });
            }

            // 2. éšæœºè¡¥é½
            while (roundWinners.length < count && available.length > 0) {
                const idx = Math.floor(Math.random() * available.length);
                roundWinners.push(available.splice(idx, 1)[0]);
            }

            winners.push(...roundWinners);

            // å‰å°å±•ç¤ºç»“æœ
            const slots = document.querySelectorAll('.slot-item');
            slots.forEach((slot, i) => {
                if (roundWinners[i]) {
                    slot.innerText = roundWinners[i];
                    slot.className = 'slot-item mode-winner';
                } else {
                    slot.innerText = ""; // ç©ºç™½å ä½
                }
            });

            // è®°å½•åˆ°å†å²
            const history = document.getElementById('history-area');
            const row = document.createElement('div');
            row.className = 'history-item';
            row.innerHTML = `<strong>ç¬¬ ${currentRound} è½®ï¼š</strong> ${roundWinners.join('ã€')}`;
            history.insertBefore(row, history.firstChild);

            currentRound++;
            document.getElementById('status-round').innerText = currentRound;
            updateStatus();
        }
    }
</script>
</body>
</html>
